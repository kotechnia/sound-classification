# sound-classification

❏ sound-classification의 구조는 다음과 같습니다
```bash
📂
├─ 📂data ( NIA datasets )
│   ├─ 📂라벨링데이터
│   └─ 📂원천데이터
├─ 📂docker
├─ 📂ignite_trainer
├─ 📂model
├─ 📂protocols
│   └─ 📂nia2022
├─ 📂reproduced
├─ 📂utils
├─ 📄README.md
├─ 📄main.py
├─ 📉dataset.csv
├─ 📄prepare.py
├─ 📄requirements.txt
├─ 📉results.csv
└─ 📄test.py
```

❏ 테스트 시스템 사양은 다음과 같습니다.    
```
Ubuntu 22.04   
Python 3.8.10 
Torch 1.7.0+cu110
Torchvision==0.8.1+cu110
CUDA 11.1
cuDnn 8.2.0    
```
❏ 사용 라이브러리 및 프로그램입니다.

```
$ pip install –r requirements.txt
```

# 실행 방법

❏ dataset.csv(input csv) 생성 방법입니다.
```
python prepare.py
```
  
<details>
    <summary><b>❏ dataset.csv 구조</b></summary>
<pre>
+--------+------------------------------------------------------------------------------------+-------+--------+---------------------------------+-----------------------+---------------------------------------------------------------------------------------+
|        |                                      filename                                      | fold  | target |            category             |          key          |                                        detail                                         |
+--------+------------------------------------------------------------------------------------+-------+--------+---------------------------------+-----------------------+---------------------------------------------------------------------------------------+
|   0    |  data/원천데이터/05.기타소음/03.전자제품및생활환경소리/05_03_816_220831_0032_SN.wav   | train |   6    |  전자제품및생활환경소리_생활환경   | 05_03_816_220831_0032 |  data/라벨링데이터/05.기타소음/03.전자제품및생활환경소리/05_03_816_220831_0032_SN.json   |
|   1    |  data/원천데이터/05.기타소음/03.전자제품및생활환경소리/05_03_816_220831_0032_NS.wav   | train |   6    |  전자제품및생활환경소리_생활환경   | 05_03_816_220831_0032 |  data/라벨링데이터/05.기타소음/03.전자제품및생활환경소리/05_03_816_220831_0032_SN.json   |
|   2    |  data/원천데이터/05.기타소음/03.전자제품및생활환경소리/05_03_838_220928_0107_SN.wav   |  val  |   6    |  전자제품및생활환경소리_생활환경   | 05_03_838_220928_0107 |  data/라벨링데이터/05.기타소음/03.전자제품및생활환경소리/05_03_838_220928_0107_SN.json   |
|   3    |  data/원천데이터/05.기타소음/03.전자제품및생활환경소리/05_03_838_220928_0107_NS.wav   |  val  |   6    |  전자제품및생활환경소리_생활환경   | 05_03_838_220928_0107 |  data/라벨링데이터/05.기타소음/03.전자제품및생활환경소리/05_03_838_220928_0107_SN.json   |
|::::::::|::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::|:::::::|::::::::|:::::::::::::::::::::::::::::::::|:::::::::::::::::::::::|:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::|
| 205984 |          data/원천데이터/03.공장/04.기타소리/03_04_902_220804_0107_SN.wav            | train |   0    |         기타소리_복합소리         | 03_04_902_220804_0107 |          data/라벨링데이터/03.공장/04.기타소리/03_04_902_220804_0107_SN.json           |
| 205985 |          data/원천데이터/03.공장/04.기타소리/03_04_902_220804_0107_NS.wav            | train |   0    |         기타소리_복합소리         | 03_04_902_220804_0107 |          data/라벨링데이터/03.공장/04.기타소리/03_04_902_220804_0107_SN.json           |
| 205986 |          data/원천데이터/03.공장/04.기타소리/03_04_710_221117_0015_SN.wav            | train |   0    |         기타소리_복합소리         | 03_04_710_221117_0015 |          data/라벨링데이터/03.공장/04.기타소리/03_04_710_221117_0015_SN.json           |
| 205987 |          data/원천데이터/03.공장/04.기타소리/03_04_710_221117_0015_NS.wav            | train |   0    |         기타소리_복합소리         | 03_04_710_221117_0015 |          data/라벨링데이터/03.공장/04.기타소리/03_04_710_221117_0015_SN.json           |
+--------+------------------------------------------------------------------------------------+-------+--------+---------------------------------+-----------------------+---------------------------------------------------------------------------------------+
</pre>
</details>


❏ 훈련 방법입니다.
```
python main.py --config=protocols/nia2022/nia2022.json
```

❏ 검증 방법입니다.
```
python test.py
```

# NIA 2022 sound-classification  
❏ NIA 2022 AI 학습용 데이터로 8:1:1 훈련, 검증, 실험 분할 학습 진행  
```
NIA 2022 noise-reduction 데이터 총 1000h -> train 800h valid 100h test 100h  
```
※ 전체 데이터는 [AI - HUB](https://aihub.or.kr/)에서 받을 수 있습니다.  


❏ 훈련된 모델의 ESTOI 수치 결과입니다.  
||**ESResNet**|
|:--:|:--:|
|**F1-score**|0.88|



--- 

<details>
    <summary><b>❏  original github & paper</b></summary>
    <p>github : <a href='https://github.com/AndreyGuzhov/ESResNet'>ESResNet</a>
    <p>paper : <a href='https://arxiv.org/abs/2004.07301'>arXiv:2004.07301</a>
</details>

